import React, { useState, useEffect } from 'react';
import Register from './Register';
import Login from './Login';
import CreateBlog from './CreateBlog';
import Logout from "./Logout";// Assuming you have CreateBlog component

function Home() {
  const [showRegister, setShowRegister] = useState(false); // State to toggle Register form
  const [showLogin, setShowLogin] = useState(false); // State to toggle Login form
  const [isLoggedIn, setIsLoggedIn] = useState(false); // Check if the user is logged in
  const [token, setToken] = useState(localStorage.getItem('token')); // Retrieve token from localStorage

  useEffect(() => {
    // If the token exists, set user as logged in
    if (token) {
      setIsLoggedIn(true);
    }
  }, [token]); // Trigger effect whenever the token changes

  const handleLogout = () => {
    localStorage.removeItem('token');
    setToken(null);
    setIsLoggedIn(false);
    alert('Logged out!');
  };

  // Toggle the display of the Register form
  const toggleRegisterForm = () => {
    setShowRegister(!showRegister);
    setShowLogin(false); // Close login form when opening register
  };

  // Toggle the display of the Login form
  const toggleLoginForm = () => {
    setShowLogin(!showLogin);
    setShowRegister(false); // Close register form when opening login
  };
 const handleLogout = () => {
  setToken(null); // Clear the token in state
  setIsLoggedIn(false); // Update the login status
};
  return (
    <div>
      <h1>Welcome to the Blog</h1>
      {isLoggedIn ? (
        <>
          <h2>Welcome, you are logged in!</h2>
          <CreateBlog /> {/* Show the CreateBlog form if logged in */}
          <button onClick={handleLogout}>Logout</button>
        </>
      ) : (
        <>
          <button onClick={toggleLoginForm}>Login</button>
          <button onClick={toggleRegisterForm}>Register</button>

          {/* Conditionally render Login or Register form */}
          {showLogin && <Login />}
          {showRegister && <Register />}
        </>
      )}
    </div>
  );
}

export default Home;
